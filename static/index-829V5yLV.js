import{f as S,_ as K}from"./index-7BawNCQw.js";import{w as L,r as W,x as X,y as Y,z as ee,A as ae,E as P,B as te}from"./element-FGu17exM.js";import{Z as x,l as le,r as C,b as ne,ag as u,aq as oe,p as re,V as F,M as h,O as a,T as e,m as f,u as r,S as s,q as z,R as se,Q as ue}from"./vue-iKzacZb4.js";function ie(i){return S({url:"table",method:"post",data:i})}function de(i){return S({url:`table/${i}`,method:"delete"})}function ce(i){return S({url:"table",method:"put",data:i})}function pe(i){return S({url:"table",method:"get",params:i})}const me={total:0,currentPage:1,pageSizes:[10,20,50],pageSize:10,layout:"total, sizes, prev, pager, next, jumper"};function fe(i={}){const p=x({...me,...i});return{paginationData:p,handleCurrentChange:w=>{p.currentPage=w},handleSizeChange:w=>{p.pageSize=w}}}const _e={class:"app-container"},ge={class:"toolbar-wrapper"},he={class:"table-wrapper"},ve={class:"pager-wrapper"},be=le({name:"ElementPlus",__name:"index",setup(i){const p=C(!1),{paginationData:o,handleCurrentChange:T,handleSizeChange:w}=fe(),_=C(!1),B=C(null),d=x({username:"",password:""}),N=x({username:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}]}),M=()=>{var n;(n=B.value)==null||n.validate((l,y)=>{l?v.value===void 0?ie(d).then(()=>{P.success("新增成功"),b()}).finally(()=>{_.value=!1}):ce({id:v.value,username:d.username}).then(()=>{P.success("修改成功"),b()}).finally(()=>{_.value=!1}):console.error("表单校验不通过",y)})},I=()=>{v.value=void 0,d.username="",d.password=""},j=n=>{te.confirm(`正在删除用户：${n.username}，确认删除？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{de(n.id).then(()=>{P.success("删除成功"),b()})})},v=C(void 0),O=n=>{v.value=n.id,d.username=n.username,_.value=!0},D=C([]),U=C(null),g=x({username:"",phone:""}),b=()=>{p.value=!0,pe({currentPage:o.currentPage,size:o.pageSize,username:g.username||void 0,phone:g.phone||void 0}).then(n=>{o.total=n.data.total,D.value=n.data.list}).catch(()=>{D.value=[]}).finally(()=>{p.value=!1})},R=()=>{o.currentPage===1?b():o.currentPage=1},Q=()=>{var n;(n=U.value)==null||n.resetFields(),R()};return ne([()=>o.currentPage,()=>o.pageSize],b,{immediate:!0}),(n,l)=>{const y=u("el-input"),k=u("el-form-item"),c=u("el-button"),$=u("el-form"),q=u("el-card"),A=u("el-tooltip"),m=u("el-table-column"),V=u("el-tag"),Z=u("el-table"),G=u("el-pagination"),H=u("el-dialog"),E=oe("loading");return f(),re("div",_e,[F((f(),h(q,{shadow:"never",class:"search-wrapper"},{default:a(()=>[e($,{ref_key:"searchFormRef",ref:U,inline:!0,model:g},{default:a(()=>[e(k,{prop:"username",label:"用户名"},{default:a(()=>[e(y,{modelValue:g.username,"onUpdate:modelValue":l[0]||(l[0]=t=>g.username=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(k,{prop:"phone",label:"手机号"},{default:a(()=>[e(y,{modelValue:g.phone,"onUpdate:modelValue":l[1]||(l[1]=t=>g.phone=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(k,null,{default:a(()=>[e(c,{type:"primary",icon:r(L),onClick:R},{default:a(()=>[s("查询")]),_:1},8,["icon"]),e(c,{icon:r(W),onClick:Q},{default:a(()=>[s("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1})),[[E,p.value]]),F((f(),h(q,{shadow:"never"},{default:a(()=>[z("div",ge,[z("div",null,[e(c,{type:"primary",icon:r(X),onClick:l[2]||(l[2]=t=>_.value=!0)},{default:a(()=>[s("新增用户")]),_:1},8,["icon"]),e(c,{type:"danger",icon:r(Y)},{default:a(()=>[s("批量删除")]),_:1},8,["icon"])]),z("div",null,[e(A,{content:"下载"},{default:a(()=>[e(c,{type:"primary",icon:r(ee),circle:""},null,8,["icon"])]),_:1}),e(A,{content:"刷新当前页"},{default:a(()=>[e(c,{type:"primary",icon:r(ae),circle:"",onClick:b},null,8,["icon"])]),_:1})])]),z("div",he,[e(Z,{data:D.value},{default:a(()=>[e(m,{type:"selection",width:"50",align:"center"}),e(m,{prop:"username",label:"用户名",align:"center"}),e(m,{prop:"roles",label:"角色",align:"center"},{default:a(t=>[t.row.roles==="admin"?(f(),h(V,{key:0,effect:"plain"},{default:a(()=>[s("admin")]),_:1})):(f(),h(V,{key:1,type:"warning",effect:"plain"},{default:a(()=>[s(se(t.row.roles),1)]),_:2},1024))]),_:1}),e(m,{prop:"phone",label:"手机号",align:"center"}),e(m,{prop:"email",label:"邮箱",align:"center"}),e(m,{prop:"status",label:"状态",align:"center"},{default:a(t=>[t.row.status?(f(),h(V,{key:0,type:"success",effect:"plain"},{default:a(()=>[s("启用")]),_:1})):(f(),h(V,{key:1,type:"danger",effect:"plain"},{default:a(()=>[s("禁用")]),_:1}))]),_:1}),e(m,{prop:"createTime",label:"创建时间",align:"center"}),e(m,{fixed:"right",label:"操作",width:"150",align:"center"},{default:a(t=>[e(c,{type:"primary",text:"",bg:"",size:"small",onClick:J=>O(t.row)},{default:a(()=>[s("修改")]),_:2},1032,["onClick"]),e(c,{type:"danger",text:"",bg:"",size:"small",onClick:J=>j(t.row)},{default:a(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),z("div",ve,[e(G,{background:"",layout:r(o).layout,"page-sizes":r(o).pageSizes,total:r(o).total,"page-size":r(o).pageSize,currentPage:r(o).currentPage,onSizeChange:r(w),onCurrentChange:r(T)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[E,p.value]]),e(H,{modelValue:_.value,"onUpdate:modelValue":l[6]||(l[6]=t=>_.value=t),title:v.value===void 0?"新增用户":"修改用户",onClose:I,width:"30%"},{footer:a(()=>[e(c,{onClick:l[5]||(l[5]=t=>_.value=!1)},{default:a(()=>[s("取消")]),_:1}),e(c,{type:"primary",onClick:M},{default:a(()=>[s("确认")]),_:1})]),default:a(()=>[e($,{ref_key:"formRef",ref:B,model:d,rules:N,"label-width":"100px","label-position":"left"},{default:a(()=>[e(k,{prop:"username",label:"用户名"},{default:a(()=>[e(y,{modelValue:d.username,"onUpdate:modelValue":l[3]||(l[3]=t=>d.username=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),v.value===void 0?(f(),h(k,{key:0,prop:"password",label:"密码"},{default:a(()=>[e(y,{modelValue:d.password,"onUpdate:modelValue":l[4]||(l[4]=t=>d.password=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1})):ue("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),ke=K(be,[["__scopeId","data-v-2a953a43"]]);export{ke as default};
